/ {
    chosen {
        zephyr,display = &oled;
        zmk,underglow = &led_strip;
    };
};

&spi3 {
    status = "okay";
    pinctrl-0 = <&spi3_default>;
    pinctrl-1 = <&spi3_sleep>;
    pinctrl-names = "default", "sleep";

    led_strip: ws2812@0 {
        compatible        = "worldsemi,ws2812-spi";
        label             = "WS2812";
        reg               = <0>;
        
        /* Decreased frequency for more stable signal */
        spi-max-frequency = <2000000>;  /* Reduced from 4MHz to 2MHz */

        chain-length      = <38>;
        
        /* Adjusted timing - try these values */
        spi-one-frame     = <0x70>;     /* You could try 0x78 or 0x7C for stronger signal */
        spi-zero-frame    = <0x40>;     /* You could try 0x30 if above doesn't work */
        
        color-mapping     = <1 0 2>;    /* GRB */
    };
};